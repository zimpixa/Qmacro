[General]
Description=Caver
BeginHotkey=51
BeginHotkeyMod=2
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=0
StopHotkeyMod=0
RunOnce=1
EnableWindow=
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[CallBack]
OnSetup=
[Comment]
Content=

[Script]
VBS dim monstercolor(8),color(3),markColor(13),waypoint
VBS dim tCDBshaker,tWalking,tAmmo,tUseSpectral,tEmberwing,tSpectral,tFoodEater,tAdditionalTasks
UserVar spellhealing=------------------------ -------------------
UserVar Mode=Main Resolution Mode (Main/Laptop/Virtual)
UserVar spellhealing1=------------------------ -------------------
UserVar Caveboter=1 Cavebot
UserVar HuntingPlace=Drefia
UserVar spellhealing2=------------------------ -------------------
UserVar AutoAttacker=1 Attack monsters on battle
UserVar Looter=1 Loot monsters around
UserVar AmmoRefiller=1 Refill bolts
UserVar spellhealing3=------------------------ -------------------
UserVar SpectralCreate=1 Create Spectral Bolts
UserVar EmberwingActive=1 Activate Emberwing
UserVar CDBshaker=1 CDB shaker
UserVar FoodEater=1 Eat Food
UserVar FoodEaterKey=114 Food Key
Rem begin
Rem Constant
SearchForLoot=0:Attacking=0:Walking=0
tAdditionalTasks=Timer():tAmmo=Timer():tUseSpectral=Timer():tCDBshaker=Timer():tSpectral=Timer():tEmberwing=Timer():tFoodEater=Timer():tWalking=Timer()
VBS waypoint=1
plusbolt=0
//1:CheckMark;2:Questionmark3:Exclamationmark;4:Star;5:Cross;6:Mouth;7:Showel;8:Sword;9:Flag;10:Locker;11:Skull;12:Dolar
//Xsign=0000E0;Bag:53779C
VBS markColor(1)="57CE44":markColor(2)="FF0F0F":markColor(3)="0000B9":markColor(4)="1C94F7":markColor(5)="042358":markColor(6)="303434":markColor(7)="0A41A0":markColor(8)="ACACAC":markColor(9)="F00101":markColor(10)="059BB6":markColor(11)="0000B9":markColor(12)="FF0F0F"
Rem Variables
If Mode="Main"
    SelfX=866:SelfY=411
    tileCenterSpace=71
    //Attacker
    Monster1HP=1600
    monster1hpY=54
    monsterPixColor="000000"
    attacksqX=1572:attacksqY=38:attacksqEndY=133
    VBS color(0)="0000FF": color(1)="8080FF"
    //AmmoRefiller
    quiverX=1842:quiverY=272
    quiverPixColor="555250"
    actionBarSpectralX=1439:actionBarSpectralY=835
    spectralexistPixColor="71CFFF"
    actionbarBoltX=1400:actionbarBoltY=835
    //CDBshaker
    shakerX=1074:shakerY=835
    shakerPixColor="1100AD"
    //ManaLevelChecker
    ManaX=45/100*(1857-1771)+1771
    ManaY=161
    manaPixColor="FF7174"
    //SpectralCreate
    spectralX=895:spectralY=835
    spectralCDX=895:spectralCDY=819
    spectralColor="A5B705"
    //EmberwingActive
    emberwingABX=400:emberwingABY=835
    emberwingCDX=391:emberwingCDY=819
    emberwingColor="BA0F7E"
    //Cavebot
    mapX=1753:mapY=27
    //mapX+105:mapY+108
    mapEndX=1858:mapEndY=135
    mapcenterX=1805:mapcenterY=81
ElseIf Mode="Laptop"
    SelfX=591:SelfY=306
    tileCenterSpace=55
    //Attacker
    Monster1HP=1070
    monster1hpY=33
    monsterPixColor="000000"
    attacksqX=1019:attacksqY=17:attacksqEndY=112
    VBS color(0)="0000FF": color(1)="8080FF"
    //AmmoRefiller
    quiverX=1289:quiverY=251
    quiverPixColor="555250"
    actionBarSpectralX=864:actionBarSpectralY=642
    spectralexistPixColor="71CFFF"
    actionbarBoltX=826:actionbarBoltY=642
    //CDBshaker
    shakerX=679:shakerY=642
    shakerPixColor="1100AD"
    //ManaLevelChecker
    ManaX=45/100*(1303-1217)+1217
    ManaY=140
    manaPixColor="FF7174"
    //SpectralCreate
    spectralX=789:spectralY=642
    spectralCDX=788:spectralCDY=626
    spectralColor="A5B705"
    //EmberwingActive
    emberwingABX=717:emberwingABY=642
    emberwingCDX=716:emberwingCDY=626
    emberwingColor="BA0F7E"
    //Cavebot
    mapX=1200:mapY=6
    //mapX+105:mapY+108
    mapEndX=1305:mapEndY=114
    mapcenterX=1252:mapcenterY=60
EndIf 
If HuntingPlace="Drefia"
    //ADD NEW MONSTERS TO IF AT LOOTER
    VBS monstercolor(0)="050505"
    VBS monstercolor(1)="434D5B"
    VBS monstercolor(2)="171717"
    VBS monstercolor(3)="433971"
    //ADD NEW MONSTERS TO IF AT LOOTER
    waypointcount=10
ElseIf HuntingPlace="Drefia2"
    //ADD NEW MONSTERS TO IF AT LOOTER
    VBS monstercolor(0)="050505"
    VBS monstercolor(1)="433971"
    VBS monstercolor(2)="171717"
    //ADD NEW MONSTERS TO IF AT LOOTER
    waypointcount=9
ElseIf HuntingPlace="MutatedTiger"
    //ADD NEW MONSTERS TO IF AT LOOTER
    VBS monstercolor(0)="141845"
    VBS monstercolor(1)="223D87"
    VBS monstercolor(2)="2A4595"
    VBS monstercolor(3)="2A4358"
    //ADD NEW MONSTERS TO IF AT LOOTER
    waypointcount=10
EndIf 
VBSCall Start=GetPixelColor(0,0)
Rem Script
Delay 150
//MoveTo SelfX,SelfY
//AutoAttack START
If AutoAttacker=1
    VBSCall monsterPix=GetPixelColor(Monster1HP,monster1hpY)
    //SayString("X: "&monsterPix)
    If monsterPix=monsterPixColor
		Rem MonsterFound
        Attacking=1
        VBSCall FindColor(attacksqX,attacksqY,attacksqX,attacksqEndY,color(0),atk0X,atk0Y)
        VBSCall FindColor(attacksqX,attacksqY,attacksqX,attacksqEndY,color(1),atk1X,atk1Y)
        If atk0X<0 and atk1Y<0
            KeyPress 27,1
            SaveMousePos 
            MoveTo Monster1HP,monster1hpY
            Delay 50
            LeftClick 1
            Delay 50
            RestoreMousePos 
            If SearchForLoot = 1
                Goto LootAnyway
            EndIf 
            SearchForLoot=1
        Else 
            SearchForLoot=1
        EndIf 
    Else 
        Attacking=0
    EndIf 
EndIf 
//AutoAttack END
//Looter START
If Looter=1
    If SearchForLoot=1
        VBSCall monsterPix=GetPixelColor(Monster1HP,monster1hpY)
        If monsterPix<>monsterPixColor
            Rem LootAnyway
			//Try800
            Delay 900
            squarespace=tileCenterSpace
            i=1
            lootsqX=SelfX:lootsqY=SelfY
            For 3
                spaceX=0:spaceY=squarespace
                For 2
                    For i
                        //SayString("X+: "&spaceX&" Y+: "&spaceY&" X: "&lootsqX&" Y: "&lootsqY)
                        lootsqX=lootsqX+spaceX:lootsqY=lootsqY+spaceY
                        If i>2 and lootsqY=(SelfY+squarespace+squarespace)
                            Goto LooterEnd
                        EndIf 
                        VBSCall lootPixel=GetPixelColor(lootsqX,lootsqY)
                        //SayString("X: "&lootsqX&" Y: "&lootsqY&" Color: "&lootPixel&" i: "&i)
                        If lootPixel=monstercolor(0) or lootPixel=monstercolor(1) or lootPixel=monstercolor(2) or lootPixel=monstercolor(3)
                            SaveMousePos 
                            MoveTo lootsqX,lootsqY
							//Try50/50
                            Delay 100
                            RightClick 1
                            Delay 100
                            RestoreMousePos 
                        EndIf 
                    EndFor 
                    spaceX=squarespace:spaceY=0
                EndFor 
                i=i+1:squarespace=squarespace*(-1)
            EndFor 
            Rem LooterEnd
			VBSCall monsterPix=GetPixelColor(Monster1HP,monster1hpY)
            If monsterPix=monsterPixColor
                Goto MonsterFound
            EndIf 
            SearchForLoot=0
            Attacking=0
            tWalking=Timer()
        EndIf 
    EndIf 
EndIf 
//Looter END
//AmmoRefiller START
If AmmoRefiller=1
    If tAmmo<Timer()
        VBSCall quiverPix=GetPixelColor(quiverX,quiverY)
        //VBSCall Call MessageBox("X: "&quiverPix)
        If quiverPix=quiverPixColor
            If tUseSpectral<=Timer()
                VBSCall spectralexistPix=GetPixelColor(actionBarSpectralX,actionBarSpectralY)
                If spectralexistPix=spectralexistPixColor
                    plusbolt=40
                Else 
                    plusbolt=0
                EndIf 
            Else 
                plusbolt=0
            EndIf 
            SaveMousePos 
            MoveTo actionbarBoltX+plusbolt,actionbarBoltY
            Delay 10
            LeftClick 1
            Delay 100
            RestoreMousePos 
            tAmmo=Timer()+1
        EndIf 
    EndIf 
EndIf 
//AmmoRefiller END
If tAdditionalTasks<=Timer()
    tAdditionalTasks=Timer()+10
    //CDBshaker START
    If CDBshaker=1
        If tCDBshaker<=Timer()
            VBSCall shakerPix=GetPixelColor(shakerX,shakerY)
            If shakerPix=shakerPixColor
                //cpix=GetPixelColor(shakerX,shakerY)
                SaveMousePos 
                MoveTo shakerX,shakerY
                Delay 10
                LeftClick 1
                Delay 100
                RestoreMousePos 
                tCDBshaker=Timer()+30
            EndIf 
        EndIf 
    EndIf 
    //CDBshaker END
    //SpectralCreate START
    If SpectralCreate=1
        If tSpectral<=Timer()
            VBSCall spectralPix=GetPixelColor(spectralCDX,spectralCDY)
            If spectralPix=spectralColor
                manaPix=GetPixelColor(ManaX,manaY)
                If manaPix=manaPixColor
                    SaveMousePos 
                    MoveTo spectralX,spectralY
                    Delay 10
                    LeftClick 1
                    Delay 100
                    RestoreMousePos 
                    tSpectral=Timer()+601
                EndIf 
            Else 
                tSpectral=Timer()+20
            EndIf 
        EndIf 
    EndIf 
    //SpectralCreate END
    //EmberwingActive START
    If EmberwingActive=1
        If tEmberwing<=Timer()
            VBSCall emberwingPix=GetPixelColor(emberwingCDX,emberwingCDY)
            If emberwingPix=emberwingColor
                VBSCall manaPix=GetPixelColor(ManaX,manaY)
                If manaPix=manaPixColor
                    SaveMousePos 
                    MoveTo emberwingABX,emberwingABY
                    Delay 10
                    LeftClick 1
                    Delay 200
                    RestoreMousePos 
                    tEmberwing=Timer()+1801
                    tUseSpectral=Timer()+840
                EndIf 
            Else 
                tEmberwing=Timer()+60
            EndIf 
        EndIf 
    EndIf 
    //EmberwingActive END
    //FoodEater START
    If FoodEater=1
        If tFoodEater<=Timer()
            KeyPress FoodEaterKey 1
            tFoodEater=Timer()+90
        EndIf 
    EndIf 
    //FoodEater END
EndIf 
//Cavebot START
Rem Caveboter
If Caveboter=1
    If Attacking=0
        If waypoint>waypointcount
            VBS waypoint=1
        EndIf 
        If Walking=1
            VBSCall ontargetPix=GetPixelColor(mapcenterX,mapcenterY)
            //SayString(ontargetPix&" ")
            If ontargetPix=markColor(waypoint)
                Walking=0
                tWalking=Timer()
                VBS waypoint=waypoint+1
                Goto Caveboter
            EndIf 
        EndIf 
        If tWalking<=Timer()
            VBSCall FindColor(mapX,mapY,mapEndX,mapEndY,markColor(waypoint),waypointX,waypointY)
            If waypointX>=0 and waypointY>=0
                SaveMousePos 
                MoveTo waypointX,waypointY
                Delay 40
                LeftClick 1
                Delay 40
                RestoreMousePos 
                Walking=1
                tWalking=Timer()+4
            EndIf 
        EndIf 
    EndIf 
EndIf 
Rem CavebotEND
//Cavebot END
//Midnight START
If (tWalking-Timer()>1000 or tCDBshaker-Timer()>1000) and Timer()<2000
    tWalking=Timer():tCDBshaker=Timer():tAmmo=Timer():tSpectral=Timer():tEmberwing=Timer():tUseSpectral=Timer():tFoodEater=Timer():tAdditionalTasks=Timer()
EndIf 
//Midnight END
Goto Script
----TODO----
